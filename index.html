<!DOCTYPE html>
<html>
<head>
    <title>Klyppr - Automatic Video Silence Clipper</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-wrapper">
        <div class="container">
            <header class="header">
                <h1 class="title">üé¨ Klyppr</h1>
                <p class="subtitle">Automatic Video Silence Clipper</p>
            </header>

            <main class="main-content">
                <section class="file-selection">
                    <div class="form-group">
                        <label class="form-label">üìπ Input Video</label>
                        <div class="input-group">
                            <input type="text" id="inputPath" readonly placeholder="Select video file..." class="file-input">
                            <button class="browse-btn" onclick="selectInput()">
                                <span class="btn-text">Browse</span>
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">üìÅ Output Folder</label>
                        <div class="input-group">
                            <input type="text" id="outputPath" readonly placeholder="Select output folder..." class="file-input">
                            <button class="browse-btn" onclick="selectOutput()">
                                <span class="btn-text">Browse</span>
                            </button>
                        </div>
                    </div>
                </section>

                <section class="presets-section">
                    <h3 class="section-title">‚ö° Quick Presets</h3>
                    <div class="button-group">
                        <button class="preset-btn active" data-preset="recommended">
                            <span class="preset-icon">üéØ</span>
                            <span class="preset-name">Recommended</span>
                            <span class="preset-desc">Balanced quality</span>
                        </button>
                        <button class="preset-btn" data-preset="fast">
                            <span class="preset-icon">‚ö°</span>
                            <span class="preset-name">Extra Fast</span>
                            <span class="preset-desc">Quick processing</span>
                        </button>
                    </div>
                </section>

                <section class="settings-section">
                    <h3 class="section-title">üîß Advanced Settings</h3>
                    <div id="customSettings" class="settings-group visible">
                        <div class="settings-grid">
                            <div class="form-group">
                                <label class="form-label">üîá Silence Threshold (dB)</label>
                                <input type="number" id="silenceDb" value="-35" step="1" class="number-input">
                            </div>

                            <div class="form-group">
                                <label class="form-label">‚è±Ô∏è Min. Silence Duration (sec)</label>
                                <input type="number" id="minSilenceDuration" value="0.5" step="0.1" min="0" class="number-input">
                            </div>

                            <div class="form-group">
                                <label class="form-label">üìè Padding Duration (sec)</label>
                                <input type="number" id="paddingDuration" value="0.05" step="0.01" min="0" class="number-input">
                            </div>
                        </div>
                        
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="normalizeAudio" checked class="checkbox-input">
                                <span class="checkbox-text">
                                    <span class="checkbox-icon">üéöÔ∏è</span>
                                    <span class="checkbox-title">Normalize Audio (YouTube Standard)</span>
                                    <span class="checkbox-desc">Adjust volume to -16 LUFS (MrBeast/YouTube level)</span>
                                </span>
                            </label>
                        </div>
                    </div>
                </section>

                <section class="action-section">
                    <button id="startBtn" onclick="startProcessing()" disabled class="start-btn">
                        <span class="btn-icon">üöÄ</span>
                        <span class="btn-text">Start Processing</span>
                    </button>
                </section>

                <section class="progress-section">
                    <div id="progress" class="progress-container">
                        <div class="progress-info">
                            <span class="progress-label">Processing status:</span>
                            <span id="status" class="progress-status">Preparing...</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-bar-fill" id="progressBar"></div>
                        </div>
                    </div>
                </section>

                <section class="log-section">
                    <div id="log" class="log-container"></div>
                </section>

                <section class="result-section" id="resultSection" style="display: none;">
                    <button id="showInFolderBtn" class="show-folder-btn" onclick="showInFolder()">
                        <span class="btn-icon">üìÅ</span>
                        <span class="btn-text">Show Video in Folder</span>
                    </button>
                </section>
            </main>
        </div>
    </div>

    <script>
        const { ipcRenderer } = require('electron');
        
        // Preset deƒüerleri
        const presets = {
            recommended: {
                silenceDb: -35,
                minSilenceDuration: 0.5,
                paddingDuration: 0.05
            },
            fast: {
                silenceDb: -30,              
                minSilenceDuration: 0.4,     
                paddingDuration: 0.035       
            }
        };

        // Preset butonlarƒ± i√ßin olay dinleyicileri
        document.querySelectorAll('.preset-btn').forEach(button => {
            button.addEventListener('click', () => {
                // Aktif butonu deƒüi≈ütir
                document.querySelectorAll('.preset-btn').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');

                const preset = button.dataset.preset;
                const values = presets[preset];
                document.getElementById('silenceDb').value = values.silenceDb;
                document.getElementById('minSilenceDuration').value = values.minSilenceDuration;
                document.getElementById('paddingDuration').value = values.paddingDuration;
            });
        });

        function selectInput() {
            ipcRenderer.send('select-input');
        }

        function selectOutput() {
            ipcRenderer.send('select-output');
        }

        function startProcessing() {
            const params = {
                inputPath: document.getElementById('inputPath').value,
                outputPath: document.getElementById('outputPath').value,
                silenceDb: document.getElementById('silenceDb').value,
                minSilenceDuration: document.getElementById('minSilenceDuration').value,
                paddingDuration: document.getElementById('paddingDuration').value,
                normalizeAudio: document.getElementById('normalizeAudio').checked
            };

            document.getElementById('startBtn').disabled = true;
            document.getElementById('progress').style.display = 'block';
            document.getElementById('log').style.display = 'block';
            document.getElementById('resultSection').style.display = 'none';
            document.getElementById('status').textContent = 'Starting process...';

            // Progress bar'ƒ± sƒ±fƒ±rla
            document.getElementById('progressBar').style.width = '0%';
            
            // Log'u temizle
            document.getElementById('log').innerHTML = '';

            ipcRenderer.send('start-processing', params);
        }

        ipcRenderer.on('input-selected', (event, path) => {
            document.getElementById('inputPath').value = path;
            updateStartButton();
        });

        ipcRenderer.on('output-selected', (event, path) => {
            document.getElementById('outputPath').value = path;
            updateStartButton();
        });

        ipcRenderer.on('progress', (event, data) => {
            document.getElementById('status').textContent = data.status;
            document.getElementById('progressBar').style.width = `${data.percent}%`;
        });

        ipcRenderer.on('log', (event, message) => {
            const log = document.getElementById('log');
            log.innerHTML += message + '<br>';
            log.scrollTop = log.scrollHeight;
        });

        let currentOutputFile = null;

        ipcRenderer.on('completed', (event, result) => {
            document.getElementById('startBtn').disabled = false;
            document.getElementById('status').textContent = result.success ? 'Process completed!' : 'Error occurred!';
            if (result.success) {
                currentOutputFile = result.outputFile;
                
                // ƒ∞≈ülem tamamlandƒ±ƒüƒ±nda progress bar'ƒ± %100'e tamamla
                document.getElementById('progressBar').style.width = '100%';
                
                // Show in folder butonu g√∂ster
                document.getElementById('resultSection').style.display = 'block';
                
                // 1 saniye sonra progress'i gizle
                setTimeout(() => {
                    document.getElementById('progress').style.display = 'none';
                    document.getElementById('progressBar').style.width = '0%';
                }, 1000);
            }
        });

        function showInFolder() {
            if (currentOutputFile) {
                ipcRenderer.send('show-in-folder', currentOutputFile);
            }
        }

        function updateStartButton() {
            const inputPath = document.getElementById('inputPath').value;
            const outputPath = document.getElementById('outputPath').value;
            document.getElementById('startBtn').disabled = !(inputPath && outputPath);
        }

        // Sayfa y√ºklendiƒüinde son output path'i y√ºkle
        window.addEventListener('DOMContentLoaded', () => {
            ipcRenderer.send('load-last-output');
        });
    </script>
</body>
</html> 